<div class="addEvent">
  <form class="form" [formGroup]="addEventForm" (ngSubmit)="addEvent()">

    <h3>Add new Event</h3>

    <div class="form-group">
      <label for="eventName">Event name</label>
      <input type="text" name="eventName" formControlName="eventName" class="text-input form-control" id="eventName"
             placeholder="Enter event name">
      <div *ngIf="submitted && addEventForm.controls.eventName.errors" class="error">
        <small class="form-text text-danger" *ngIf="addEventForm.controls.eventName.errors.required">
          Event name is required!
        </small>
        <small class="form-text text-danger" *ngIf="addEventForm.controls.eventName.errors.maxLength">
          Event name cannot be more than 100 characters!
        </small>
      </div>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <textarea name="description" formControlName="description" rows="3" class="form-control" id="description"
                placeholder="Enter description"></textarea>
      <div *ngIf="submitted && addEventForm.controls.description.errors" class="error">
        <small class="form-text text-danger" *ngIf="addEventForm.controls.description.errors.required">
          Description is required!
        </small>
        <small class="form-text text-danger" *ngIf="addEventForm.controls.description.errors.maxLength">
          Description cannot be more than 100 characters!
        </small>
      </div>
    </div>

    <div class="form-group">
      <label for="date">Date</label>
      <input type="datetime-local" name="date" formControlName="date" class="form-control" id="date">
      <div *ngIf="submitted && addEventForm.controls.date.errors" class="error">
        <small class="form-text text-danger" *ngIf="addEventForm.controls.date.errors.required">
          Date is required!
        </small>
        <small class="form-text text-danger" *ngIf="addEventForm.controls.date.errors.invalidDate">
          Date must be in the future!
        </small>
      </div>
    </div>

    <div class="form-group">
      <label for="eventType">Eventtype</label>
      <select name="eventType" id="eventType" formControlName="eventType" class="select-input form-select">
        <option value="CONCERT">Concert</option>
        <option value="OPERA">Opera</option>
        <option value="CINEMA">Cinema</option>
        <option value="THEATRE">Theatre</option>
      </select>
      <div *ngIf="submitted && addEventForm.controls.eventType.errors" class="error">
        <small class="form-text text-danger" *ngIf="addEventForm.controls.eventType.errors.required">
          Eventtype is
          required!
        </small>
      </div>
    </div>

    <div class="form-group">
      <label for="duration">Duration</label>
      <input type="number" name="duration" formControlName="duration" class="form-control" id="duration">
      <div *ngIf="submitted && addEventForm.controls.duration.errors" class="error">
        <small class="form-text text-danger" *ngIf="addEventForm.controls.duration.errors.required">
          Duration is
          required!
        </small>
        <small class="form-text text-danger" *ngIf="addEventForm.controls.duration.errors.min">
          Duration must be greater than 0!
        </small>
      </div>
    </div>

    <div class="form-group">
      <label for="files">Picture Upload</label>
      <p id="file-info">Supported formats: jpg, jpeg, png. The maximum file size is 1MB.</p>
      <input formControlName="files" id="files" type="file" class="form-control" (change)="onFileChange($event)">
      <div *ngIf="submitted && files.length === 0" class="alert alert-danger">
        <div>Atleast one image required</div>
      </div>
      <div *ngIf="fileNoImage" class="alert alert-danger">
        <div>The uploaded file is no image</div>
      </div>
      <div *ngIf="tooManyFiles" class="alert alert-danger">
        <div>Max. 10 images per event</div>
      </div>
      <div *ngIf="fileTooBig" class="alert alert-danger">
        <div>File must be smaller than 1MB</div>
      </div>
    </div>

    <div *ngIf="files.length > 0">
      <table class="table">
        <thead>
        <tr>Name</tr>
        <tr style="width: 5%"></tr>
        </thead>
        <tbody>
        <tr *ngFor="let image of files; let i = index">
          <td>{{image.name}}</td>
          <td><button type="button" class="btn btn-secondary" style="width: 100%" (click)="removeImage(i)">X</button></td>
        </tr>
        </tbody>
      </table>
    </div>

    <hr/>

    <div id="sectorTypeGroup">
      <h5>Sector Types</h5>
      <div class="row">
        <div class="col-6">
          <div class="form-group">
            <label for="sectorName">Sector Name</label>
            <input type="text" name="sectorName" formControlName="sectorName" class="text-input form-control" id="sectorName"
                   placeholder="Enter sector name">
            <div *ngIf="sectorError.name" class="error">
              <small class="form-text text-danger">
                Sector Name is required!
              </small>
            </div>
          </div>
        </div>

        <div class="col-6">
          <div class="form-group">
            <label for="sectorNumberOfTickets">Number of tickets in sector</label>
            <input type="number" name="sectorNumberOfTickets" formControlName="sectorNumberOfTickets" class="text-input form-control" id="sectorNumberOfTickets"
                   placeholder="Enter number of tickets">
            <div *ngIf="sectorError.numberOfTickets" class="error">
              <small class="form-text text-danger">
                Number of tickets must be greater than 0!
              </small>
            </div>
          </div>
        </div>
      </div>
      <div class="col-3">
        <button class="primary" type="button" (click)="addSectorType()">Add sector type</button>
      </div>

      <div *ngIf="sectorTypes.length > 0">
        <table class="table">
          <tr>
          <th>Name</th>
          <th>Number of Tickets</th>
          </tr>
          <tbody>
          <tr *ngFor="let sectorType of sectorTypes; let i = index">
            <td>{{sectorType.name}}</td>
            <td>{{sectorType.numberOfTickets}}</td>
            <td><button type="button" class="btn btn-secondary" style="width: 100%" (click)="removeSectorType(i)">X</button></td>
          </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="sectorTypes.length === 0 && submitted" class="error">
        <small class="form-text text-danger">
          Atleast one sector type required!
        </small>
      </div>
    </div>

    <hr/>

    <div id="artistGroup">
      <h5>Artist</h5>
      <div class="row">
        <div class="col-6">
          <div class="form-group">
            <label for="artistFirstName">Artist Firstname</label>
            <input type="text" name="artistFirstName" formControlName="artistFirstName" class="text-input form-control" id="artistFirstName"
            placeholder="Enter artist firstname">
            <div *ngIf="submitted && addEventForm.controls.artistFirstName.errors" class="error">
              <small class="form-text text-danger" *ngIf="addEventForm.controls.artistFirstName.errors.required">
                Artist Firstname is required!
              </small>
            </div>
          </div>
        </div>

        <div class="col-6">
          <div class="form-group">
            <label for="artistLastName">Artist Lastname</label>
            <input type="text" name="artistLastName" formControlName="artistLastName" class="text-input form-control" id="artistLastName"
            placeholder="Enter artist lastname">
            <div *ngIf="submitted && addEventForm.controls.artistLastName.errors" class="error">
              <small class="form-text text-danger" *ngIf="addEventForm.controls.artistLastName.errors.required">
                Artist Lastname is required!
              </small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <hr/>

    <div id="addressGroup">
      <h5>Location</h5>
      <div class="form-group">
        <label for="addressName">Address Name</label>
        <input type="text" name="addressName" formControlName="addressName" class="text-input form-control"
               id="addressName" aria-describedby="addressNameHelp" placeholder="Enter Address Name">
        <div *ngIf="submitted && addEventForm.controls.addressName.errors" class="error">
          <small class="form-text text-danger" *ngIf="addEventForm.controls.addressName.errors.required"> Address Name
            is
            required!
          </small>
        </div>
      </div>

      <div class="form-group">
        <label for="lineOne">Line One</label>
        <input type="text" name="lineOne" formControlName="lineOne" class="text-input form-control" id="lineOne"
               aria-describedby="lineOneHelp" placeholder="Enter line one">
        <div *ngIf="submitted && addEventForm.controls.lineOne.errors" class="error">
          <small class="form-text text-danger" *ngIf="addEventForm.controls.lineOne.errors.required"> Line one is
            required!
          </small>
        </div>
      </div>

      <div class="form-group">
        <label for="lineTwo">Line Two</label>
        <input type="text" name="lineTwo" formControlName="lineTwo" class="text-input form-control" id="lineTwo"
               aria-describedby="lineTwoHelp" placeholder="Enter line two">
      </div>

      <div class="row">
        <div class="col-6">
          <div class="form-group">
            <label for="city">City Name</label>
            <input type="text" name="city" formControlName="city" class="text-input form-control" id="city"
                   aria-describedby="cityHelp" placeholder="Enter City name">
            <div *ngIf="submitted && addEventForm.controls.city.errors" class="error">
              <small class="form-text text-danger" *ngIf="addEventForm.controls.city.errors.required"> City Name is
                required!
              </small>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="form-group">
            <label for="postcode">Postcode</label>
            <input type="text" name="postcode" formControlName="postcode" class="text-input form-control" id="postcode"
                   aria-describedby="postcodeHelp" placeholder="Enter Postcode">
            <div *ngIf="submitted && addEventForm.controls.postcode.errors" class="error">
              <small class="form-text text-danger" *ngIf="addEventForm.controls.postcode.errors.required"> Postcode is
                required!
              </small>
            </div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="country">Country</label>
        <input type="text" name="country" formControlName="country" class="text-input form-control" id="country"
               aria-describedby="countryHelp" placeholder="Enter Country">
        <div *ngIf="submitted && addEventForm.controls.country.errors" class="error">
          <small class="form-text text-danger" *ngIf="addEventForm.controls.country.errors.required"> Country is
            required!
          </small>
        </div>
      </div>
    </div>

    <button type="button" (click)="addEvent()" class="primary" id="create">Create</button>

    <div *ngIf="error" class="col-12 alert alert-danger alert-dismissible fade show" role="alert">
      <strong>Error! </strong> {{ errorMessage }}
      <button type="button" (click)="vanishAlert()" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div *ngIf="success" class="col-12 alert alert-success alert-dismissible fade show" role="alert">
      <strong>Success</strong> The event is added.
      <button type="button" (click)="vanishAlert()" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
  </form>
</div>
